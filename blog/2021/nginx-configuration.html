<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Nginx常用配置 | YY物语</title>
    <meta name="description" content="记录一些Nginx常用配置项及说明。">
    <meta name="generator" content="VitePress v1.1.0">
    <link rel="preload stylesheet" href="/assets/style.H3f743DC.css" as="style">
    
    <script type="module" src="/assets/app.GLTFggJz.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.BLntPuLU.js">
    <link rel="modulepreload" href="/assets/chunks/theme.FT21jm1U.js">
    <link rel="modulepreload" href="/assets/chunks/articleMetadata.DsIh35Mt.js">
    <link rel="modulepreload" href="/assets/blog_2021_nginx-configuration.md.hclfgPua.lean.js">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileColor" content="#000000">
    <meta name="msapplication-TileImage" content="/favicon.ico">
    <meta name="baidu-site-verification" content="codeva-a9OBeZwEU6">
    <link rel="apple-touch-icon" href="/favicon.ico">
    <link rel="mask-icon" href="/favicon.ico" color="#3eaf7c">
    <script src="https://hm.baidu.com/hm.js?9327590ef57d577af3cebe5a982d84b4"></script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-d8b57b2d><!--[--><!--]--><!--[--><span tabindex="-1" data-v-c8291ffa></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-c8291ffa> Skip to content </a><!--]--><!----><header class="VPNav" data-v-d8b57b2d data-v-7ad780c2><div class="VPNavBar has-sidebar top" data-v-7ad780c2 data-v-844edcde><div class="wrapper" data-v-844edcde><div class="container" data-v-844edcde><div class="title" data-v-844edcde><div class="VPNavBarTitle has-sidebar" data-v-844edcde data-v-0ad69264><a class="title" href="/" data-v-0ad69264><!--[--><!--]--><!--[--><!--[--><!--[--><img class="VPImage dark logo" src="/logo_night.svg" alt data-v-ab19afbb><!--]--><!--[--><img class="VPImage light logo" src="/logo_light.svg" alt data-v-ab19afbb><!--]--><!--]--><!--]--><span data-v-0ad69264>YY物语</span><!--[--><!--]--></a></div></div><div class="content" data-v-844edcde><div class="content-body" data-v-844edcde><!--[--><!--]--><div class="VPNavBarSearch search" data-v-844edcde><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-844edcde data-v-f732b5d0><span id="main-nav-aria-label" class="visually-hidden" data-v-f732b5d0>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/nav" tabindex="0" data-v-f732b5d0 data-v-08fbf4b6><!--[--><span data-v-08fbf4b6>导航</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-f732b5d0 data-v-af5898d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-af5898d3><span class="text" data-v-af5898d3><!----><span data-v-af5898d3>后端物语</span><span class="vpi-chevron-down text-icon" data-v-af5898d3></span></span></button><div class="menu" data-v-af5898d3><div class="VPMenu" data-v-af5898d3 data-v-e42ed9b3><div class="items" data-v-e42ed9b3><!--[--><!--[--><div class="VPMenuLink" data-v-e42ed9b3 data-v-f51f088d><a class="VPLink link" href="/review/golang" data-v-f51f088d><!--[-->Golang篇<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e42ed9b3 data-v-f51f088d><a class="VPLink link" href="/review/python" data-v-f51f088d><!--[-->Python篇<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-f732b5d0 data-v-af5898d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-af5898d3><span class="text" data-v-af5898d3><!----><span data-v-af5898d3>Workflow</span><span class="vpi-chevron-down text-icon" data-v-af5898d3></span></span></button><div class="menu" data-v-af5898d3><div class="VPMenu" data-v-af5898d3 data-v-e42ed9b3><div class="items" data-v-e42ed9b3><!--[--><!--[--><div class="VPMenuGroup" data-v-e42ed9b3 data-v-a6b0397c><!----><!--[--><!--[--><div class="VPMenuLink" data-v-a6b0397c data-v-f51f088d><a class="VPLink link" href="/workflow/style-guide" data-v-f51f088d><!--[-->编程规范<!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-e42ed9b3 data-v-a6b0397c><!----><!--[--><!--[--><div class="VPMenuLink" data-v-a6b0397c data-v-f51f088d><a class="VPLink link" href="/workflow/css/spec" data-v-f51f088d><!--[-->常用工具库整理<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-a6b0397c data-v-f51f088d><a class="VPLink link" href="/workflow/css/tricks" data-v-f51f088d><!--[-->常用正则整理<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-a6b0397c data-v-f51f088d><a class="VPLink link" href="/workflow/sass/" data-v-f51f088d><!--[-->常用片段整理<!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-e42ed9b3 data-v-a6b0397c><!----><!--[--><!--[--><div class="VPMenuLink" data-v-a6b0397c data-v-f51f088d><a class="VPLink link" href="/workflow/css/spec" data-v-f51f088d><!--[-->命令行工具<!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-e42ed9b3 data-v-a6b0397c><!----><!--[--><!--[--><div class="VPMenuLink" data-v-a6b0397c data-v-f51f088d><a class="VPLink link" href="/workflow/css/spec" data-v-f51f088d><!--[-->Git 相关技巧<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-a6b0397c data-v-f51f088d><a class="VPLink link" href="/workflow/css/tricks" data-v-f51f088d><!--[-->Git 命令清单<!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/blog" tabindex="0" data-v-f732b5d0 data-v-08fbf4b6><!--[--><span data-v-08fbf4b6>博客</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-f732b5d0 data-v-af5898d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-af5898d3><span class="text" data-v-af5898d3><!----><span data-v-af5898d3>提效工具</span><span class="vpi-chevron-down text-icon" data-v-af5898d3></span></span></button><div class="menu" data-v-af5898d3><div class="VPMenu" data-v-af5898d3 data-v-e42ed9b3><div class="items" data-v-e42ed9b3><!--[--><!--[--><div class="VPMenuGroup" data-v-e42ed9b3 data-v-a6b0397c><p class="title" data-v-a6b0397c>软件推荐与配置</p><!--[--><!--[--><div class="VPMenuLink" data-v-a6b0397c data-v-f51f088d><a class="VPLink link" href="/efficiency/software/cross-platform" data-v-f51f088d><!--[-->多平台软件<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-a6b0397c data-v-f51f088d><a class="VPLink link" href="/efficiency/software/mac" data-v-f51f088d><!--[-->Mac 平台<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-a6b0397c data-v-f51f088d><a class="VPLink link" href="/efficiency/software/windows" data-v-f51f088d><!--[-->Windows 平台<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-a6b0397c data-v-f51f088d><a class="VPLink link" href="/efficiency/software/browser" data-v-f51f088d><!--[-->浏览器设置与扩展<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-a6b0397c data-v-f51f088d><a class="VPLink link" href="/efficiency/software/vscode" data-v-f51f088d><!--[-->Visual Studio Code 配置<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-a6b0397c data-v-f51f088d><a class="VPLink link" href="/efficiency/software/webstorm" data-v-f51f088d><!--[-->WebStorm 配置<!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuLink" data-v-e42ed9b3 data-v-f51f088d><a class="VPLink link" href="/efficiency/online-tools" data-v-f51f088d><!--[-->在线工具<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e42ed9b3 data-v-f51f088d><a class="VPLink link" href="/efficiency/bookmark-scripts" data-v-f51f088d><!--[-->书签脚本<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/about" tabindex="0" data-v-f732b5d0 data-v-08fbf4b6><!--[--><span data-v-08fbf4b6>About</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-844edcde data-v-283b26e9><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-283b26e9 data-v-7df97737 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-7df97737></span><span class="vpi-moon moon" data-v-7df97737></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-844edcde data-v-ef6192dc data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/yqchilde" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-358b6670><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-844edcde data-v-8e87c032 data-v-af5898d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-af5898d3><span class="vpi-more-horizontal icon" data-v-af5898d3></span></button><div class="menu" data-v-af5898d3><div class="VPMenu" data-v-af5898d3 data-v-e42ed9b3><!----><!--[--><!--[--><!----><div class="group" data-v-8e87c032><div class="item appearance" data-v-8e87c032><p class="label" data-v-8e87c032>Appearance</p><div class="appearance-action" data-v-8e87c032><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-8e87c032 data-v-7df97737 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-7df97737></span><span class="vpi-moon moon" data-v-7df97737></span><!--]--></span></span></button></div></div></div><div class="group" data-v-8e87c032><div class="item social-links" data-v-8e87c032><div class="VPSocialLinks social-links-list" data-v-8e87c032 data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/yqchilde" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-358b6670><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-844edcde data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><div class="divider" data-v-844edcde><div class="divider-line" data-v-844edcde></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-d8b57b2d data-v-2488c25a><div class="container" data-v-2488c25a><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2488c25a><span class="vpi-align-left menu-icon" data-v-2488c25a></span><span class="menu-text" data-v-2488c25a>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-2488c25a data-v-cd5350a7><button data-v-cd5350a7>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-d8b57b2d data-v-4871f9f5><div class="curtain" data-v-4871f9f5></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-4871f9f5><span class="visually-hidden" id="sidebar-aria-label" data-v-4871f9f5> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-4871f9f5><section class="VPSidebarItem level-0 collapsible" data-v-4871f9f5 data-v-c24f735a><div class="item" role="button" tabindex="0" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><h2 class="text" data-v-c24f735a>2022年 (8篇)</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-c24f735a><span class="vpi-chevron-right caret-icon" data-v-c24f735a></span></div></div><div class="items" data-v-c24f735a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2022/soft-route-keepalive" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 Pve上使用Shell脚本保活虚拟机</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2022/soft-route-notes" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 玩软路由的一些笔记</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2022/sophon-linaro-opencv-gocv" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 在算能盒子 (BMNN) 上使用gocv</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2022/macos-parallels-miss-tap-windows" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 解决在 Apple M1 上使用 Parallels 安装 Windows 后无法使用 OpenVPN 的问题</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2022/go-mod-private-repo" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 GoModule添加gitlab私有仓库</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2022/ubuntu-netplan" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 Ubuntu 下关于 Netplan 的一次报错</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2022/capslox-karabiner" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 如何使用 Karabiner 来代替 Capslox 的体验</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2022/uninstall-docker-on-macos" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 在Mac上彻底卸载Docker</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-4871f9f5><section class="VPSidebarItem level-0 collapsible has-active" data-v-4871f9f5 data-v-c24f735a><div class="item" role="button" tabindex="0" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><h2 class="text" data-v-c24f735a>2021年 (11篇)</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-c24f735a><span class="vpi-chevron-right caret-icon" data-v-c24f735a></span></div></div><div class="items" data-v-c24f735a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2021/ubuntu-install-golang" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 在Ubuntu上安装指定版本的Go语言</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2021/point-in-polygon-for-golang" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 Golang实现判断一个点是否在多边形中</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2021/mysql-optimization-notes" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 MySQL的优化笔记</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2021/nginx-configuration" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 Nginx常用配置</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2021/macos-remove-freespace" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 MacOS-如何删除Free Space，使得APFS容器将Free Space占用</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2021/golang-makefile-and-additional" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 Golang编译应用通过Github Release实现检测覆盖更新</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2021/template-range-crontab-regex" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 Go的template模板关于range换行和crontab的简单正则表达式</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2021/docker-compose-env-file" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 docker-compose使用env处理环境变量妙用</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2021/docker-compose-mysql-nginx" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 Docker Compose简单配置Mysql Nginx挂载持久化</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2021/docker-mysql-login-failed" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 Docker安装MySQL后无法登录</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2021/golang-race" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 Golang的Data Race问题</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-4871f9f5><section class="VPSidebarItem level-0 collapsible collapsed" data-v-4871f9f5 data-v-c24f735a><div class="item" role="button" tabindex="0" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><h2 class="text" data-v-c24f735a>2020年 (17篇)</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-c24f735a><span class="vpi-chevron-right caret-icon" data-v-c24f735a></span></div></div><div class="items" data-v-c24f735a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2020/golang-request-body-reuse" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 Golang的Request.Body复用</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2020/ubuntu-docker-permission-denied" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 Ubuntu启动Docker报没有权限</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2020/win10-missing-microsoftstore" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 MacOS-如何删除Free Space，使得APFS容器将Free Space占用</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2020/regex-lookground-verify-passowrd" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 Golang实现一个简单的密码强度验证</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2020/hugo-github-actions-aliyun" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 使用GitHub Actions部署Hugo到阿里云</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2020/git-command-quick-check" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 Git常用命令速查表</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2020/golang-json-serialization" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 Golang的json序列化详解</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2020/golang-learning-context" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 Golang的Context学习</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2020/golang-slice-expand-capacity" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 Golang的Slice扩容机制</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2020/golang-binary-calculation" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 Golang实现进制计算两种方法</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2020/golang-implements-base-data-structures" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 Golang实现几种基本数据结构</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2020/golang-trie" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 Golang实现简单Trie树</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2020/wordpress-rocket" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 正确配置rocket-nginx，加速你的wordpress</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2020/golang-base64captcha" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 Golang验证码–base64Captcha库1.3.0版本构建实例</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2020/git-clone-slow" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 Git设置代理解决git clone太慢的问题</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2020/aria-rpc-motrix-bilibili" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 油猴脚本 + Aria RPC + Motrix批量下载哔哩哔哩视频</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2020/windows-cmd-ansi" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 解决win10的cmd命令行不转义ANSI序列（让cmd输出彩色字体）</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-4871f9f5><section class="VPSidebarItem level-0 collapsible collapsed" data-v-4871f9f5 data-v-c24f735a><div class="item" role="button" tabindex="0" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><h2 class="text" data-v-c24f735a>2019年 (12篇)</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-c24f735a><span class="vpi-chevron-right caret-icon" data-v-c24f735a></span></div></div><div class="items" data-v-c24f735a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2019/golang-web-baota" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 golang写的web程序如何简单的部署到宝塔面板中</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2019/mysql-insert-how-where" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 MySQL中insert数据时怎么用where条件</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2019/mysql5.7-update-password" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 MySQL5.7修改root密码</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2019/mayisenlin-script" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 利用脚本软件“一触即发”写一个自动收取，偷取支付宝能量脚本</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2019/php-phpmailer" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 PHPMailer6.0.7如何在类中被调用</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2019/php-array" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 php多维数组降维记载</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2019/php-foreach-merge" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 php在foreach里面合并数组</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2019/uniapp-form-picker" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 uniapp的Form提交之蛋疼的picker</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2019/uniapp-generate-invitation-qrcode" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 Uni-App生成邀请二维码</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2019/uniapp-generate-random-verification-code" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 uniapp生成随机验证码&php合成验证码图片</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2019/uniapp-with-session" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 Uni-App之携带session请求</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c24f735a data-v-c24f735a><div class="item" data-v-c24f735a><div class="indicator" data-v-c24f735a></div><a class="VPLink link link" href="/blog/2019/uniapp-shoushi-huadong" data-v-c24f735a><!--[--><p class="text" data-v-c24f735a>📝 Uni-App的手势监听滑动</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-d8b57b2d data-v-9a6c75ad><div class="VPDoc has-sidebar has-aside" data-v-9a6c75ad data-v-e6f2a212><!--[--><!--]--><div class="container" data-v-e6f2a212><div class="aside" data-v-e6f2a212><div class="aside-curtain" data-v-e6f2a212></div><div class="aside-container" data-v-e6f2a212><div class="aside-content" data-v-e6f2a212><div class="VPDocAside" data-v-e6f2a212 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-cb998dce data-v-6b52fe58><div class="content" data-v-6b52fe58><div class="outline-marker" data-v-6b52fe58></div><div class="outline-title" role="heading" aria-level="2" data-v-6b52fe58>页面导航</div><nav aria-labelledby="doc-outline-aria-label" data-v-6b52fe58><span class="visually-hidden" id="doc-outline-aria-label" data-v-6b52fe58> Table of Contents for current page </span><ul class="VPDocOutlineItem root" data-v-6b52fe58 data-v-53c99d69><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e6f2a212><div class="content-container" data-v-e6f2a212><!--[--><!--]--><main class="main" data-v-e6f2a212><div style="position:relative;" class="vp-doc _blog_2021_nginx-configuration" data-v-e6f2a212><div><h1 id="nginx常用配置" tabindex="-1">Nginx常用配置 <a class="header-anchor" href="#nginx常用配置" aria-label="Permalink to &quot;Nginx常用配置&quot;">​</a></h1><!----><h2 id="nginx配置参数" tabindex="-1">Nginx配置参数 <a class="header-anchor" href="#nginx配置参数" aria-label="Permalink to &quot;Nginx配置参数&quot;">​</a></h2><h3 id="添加nginx用户" tabindex="-1">添加nginx用户 <a class="header-anchor" href="#添加nginx用户" aria-label="Permalink to &quot;添加nginx用户&quot;">​</a></h3><p>使用nginx这个用户运行，更加安全，默认nobody</p><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">user </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nginx;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="指定pid文件位置" tabindex="-1">指定pid文件位置 <a class="header-anchor" href="#指定pid文件位置" aria-label="Permalink to &quot;指定pid文件位置&quot;">​</a></h3><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">pid </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">logs/nginx.pid;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="指定日志输出位置" tabindex="-1">指定日志输出位置 <a class="header-anchor" href="#指定日志输出位置" aria-label="Permalink to &quot;指定日志输出位置&quot;">​</a></h3><p>notice指日志级别</p><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">error_log </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">logs/nginx.log </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">notice</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="性能优化相关" tabindex="-1">性能优化相关 <a class="header-anchor" href="#性能优化相关" aria-label="Permalink to &quot;性能优化相关&quot;">​</a></h2><h3 id="开启的工作进程数量" tabindex="-1">开启的工作进程数量 <a class="header-anchor" href="#开启的工作进程数量" aria-label="Permalink to &quot;开启的工作进程数量&quot;">​</a></h3><p>number通常应该为当前主机的cpu的屋里核心数</p><p>auto表示和CPU内核相关，有几个内核，就会开启几个线程</p><p>Linux系统可通过命令lscpu查看cpu核数，假如为4，则：<code>worker_processes: 4</code></p><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">worker_process</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> number|auto;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="工作进程绑定指定cpu" tabindex="-1">工作进程绑定指定CPU <a class="header-anchor" href="#工作进程绑定指定cpu" aria-label="Permalink to &quot;工作进程绑定指定CPU&quot;">​</a></h3><p>工作进程绑定指定CPU，或单个工作进程绑定到多个CPU，通常不用配置</p><p>CPU MASK: 00000001 -&gt; 0号CPU</p><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">worker_cpu_affinity </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cpumask;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">worker_cpu_affinity </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">auto cpumask; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 提高缓存命中率</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># example</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">worker_cpu_affinity </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0001</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0010</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0100</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">worker_cpu_affinity </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">auto </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0101</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1010</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="定义工作进程的调度优先级" tabindex="-1">定义工作进程的调度优先级 <a class="header-anchor" href="#定义工作进程的调度优先级" aria-label="Permalink to &quot;定义工作进程的调度优先级&quot;">​</a></h3><p>与使用<code>nice</code> 命令完成类似，负数意味着更高的优先级。允许范围为[-20,20]</p><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">worker_priority </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">number;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="一个nginx进程打开的最多文件描述符数目" tabindex="-1">一个nginx进程打开的最多文件描述符数目 <a class="header-anchor" href="#一个nginx进程打开的最多文件描述符数目" aria-label="Permalink to &quot;一个nginx进程打开的最多文件描述符数目&quot;">​</a></h3><p>这个指令是指当一个nginx进程打开的最多文件描述符数目，理论值应该是最多打开文件数（ulimit -n）一样。现在在linux2.6内核下开启文件打开数为65535，最好根据测试数据来限定，超过承受能力会导致其他访问很卡，但若限定后，其他访问正常，多出的会禁止访问。</p><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">worker_rlimit_nofile </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">65535</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="每个word进程可以建立的最大的链接数" tabindex="-1">每个word进程可以建立的最大的链接数 <a class="header-anchor" href="#每个word进程可以建立的最大的链接数" aria-label="Permalink to &quot;每个word进程可以建立的最大的链接数&quot;">​</a></h3><p>设置工作进程可以打开的同时连接的最大数量</p><p>应该记住的是，这个数字包括了所有连接（例如与代理服务器的连接等），而不仅仅是客户端的连接。另一个要考虑因素是实际的并发连接数不能超过最大打开文件数的限制，可以通过 <code>worker_rlimit_nofile</code>来修改</p><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">worker_connections </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">65535</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><code>worker_commections</code> 计算方式按照如下参考：</p><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">并发限定总数（max_clients） =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> worker_processes </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">* worker_connections</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置了反向代理后，每个并发会建立与客户端的连接和后端服务的连接，会占用两个连接</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">并发限定总数（max_clients） = worker_processes * worker_connections / 2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="io" tabindex="-1">IO <a class="header-anchor" href="#io" aria-label="Permalink to &quot;IO&quot;">​</a></h2><p>事件模型与worker进程连接数设置</p><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">events</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # epoll模型是Linux2.6以上版本内核中的高性能网络I/O模型，如果泡在FreeBSD上面，就用kqueue模型</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  use </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">epoll</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="http" tabindex="-1">Http <a class="header-anchor" href="#http" aria-label="Permalink to &quot;Http&quot;">​</a></h2><div class="language-nginx vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">http</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # ================================= 日志格式 =================================</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  log_format </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">main</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">remote_addr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> - $</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">remote_user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> [$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">time_local</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">] &quot;$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">request</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&#39;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                  &#39;$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> $</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">body_bytes_sent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">http_referer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot; &quot;$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">request_time</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&#39;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                  &#39;&quot;$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">http_user_agent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot; &quot;$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">http_x_forwarded_for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot; &quot;$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">request_time</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot; &quot;$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">content_type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&#39;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                  &#39;&quot;$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">request_body</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 日志位置</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  access_log /var/log/nginx/access.log </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  error_log </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/var/log/nginx/error.log info;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 定义日志缓存</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # max: 设置缓存中的最大描述符数，如果缓存变满，则最近最少使用（LRU）的描述符将被关闭</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # inactive: 如果在此期间没有发生访问，则设置关闭缓存描述符的时间。默认为 10 秒</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # min_uses: 设置在 inactive 参数定义的时间内文件使用的最小数量，使描述符在缓存中保持打开状态。默认为1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # valid: 设置检查同名文件是否仍然存在的时间。默认为 60 秒</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # off: 禁用缓存</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  open_log_file_cache </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">off</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  open_log_file_cache </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">max=1000 inactive=20s min_uses=2 valid=1m;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 由 ngx_http_rewrite_module 模块提供的，用来记录重写日志的，对于调试重写规则建议开启。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  rewrite_log </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # =========================================================================</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # ================================= Limit =================================</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 为指定的共享内存区域设置参数，该区域将保留各种 key 的状态。尤其是状态包括当前的连接数。key 可以包含文本、变量及其组合（1.11.2）。不计算 key 为空的连接。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # key 是一个 $binary_remote_addr 变量设置的客户端 IP 地址。$binary_remote_addr 的大小为 IPv4 地址的 4 个字节或 IPv6 地址的 16 个字节。存储状态在 32 位平台上总是占用 32 或 64 字节，在 64 位平台上占用 64 字节。一兆字节区域可以保留大约 32,000 个 32 字节状态或大约 16,000 个 64 字节状态。如果区域存储耗尽，服务器将关闭连接。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  limit_conn_zone </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$binary_remote_addr zone=addr:5m;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 设置每一个IP地址最大同时打开的连接数</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  limit_conn </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">addr </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 限速模块，指定向客户端传输数据的速度，单位是（字节数/秒）</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 注意：该限制只是针对一个连接的设定，也就是说，如果同时有两个连接，他的速度将会是指令设置的两倍</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  limit_rate </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">512k</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 限速模块，前3M下载时不限速</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  limit_rate_after </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3m</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # =========================================================================</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # ================================= 基础配置 =================================</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # SSI是英文Server Side Includes的缩写，翻译成中文就是服务器端包含的意思。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 从技术角度上说，SSI就是在HTML文件中，可以通过注释行调用的命令或指针。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # SSI具有 强大的功能，只要使用一条简单的SSI命令就可以实现整个网站的内容更新，时间和日期的动态显示，以及执行shell和CGI脚本程序等复杂的功能。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ssi </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">off</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 启用或禁用目录列表输出</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  autoindex </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">off</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 默认文件类型，默认text/plain</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  default_type </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">application/octet-stream;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 隐藏版本号</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  server_tokens </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">off</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 编码格式</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  charset </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">UTF-8;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # =========================================================================</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # ================================= 信息传输 =================================</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 开启高效文件传输模式，sendfile指令指向nginx是否调用sendfile函数来输出文件，对于普通应用设为on，如果用来进行下载等应用磁盘I/O重负载应用，可设为off，以平衡磁盘和网络I/O处理速度，降低系统的负载。如果图片显示不正确把这个改为off。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  sendfile </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 必须在sendfile开启时才有效，告诉nginx在一个数据包里发送所有头文件，而不是一个接一个的发送。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  tcp_nopush </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 必须在sendfile开启时才有效，告诉nginx不要缓存数据，而是一段一段的发送，当需要及时发送数据时，就应该给应用设置这个属性，这样发送一小块数据时就不能立即得到返回值。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  tcp_nodelay </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # =========================================================================</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # ================================= 超时设置 =================================</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 设置超时时间，在此期间与 upstream 服务器的空闲 keepalive 连接将保持打开状态</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  keepalive_timeout </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 设置请求头的超时时间，我们也可以把这个设置低些，超过这个时间没有发送任何数据，nginx将返回request timeout的错误</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  client_header_timeout </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 定义读取客户端请求头的超时时间。如果客户端在这段时间内没有传输整个报头，则将 408（请求超时）错误返回给客户端</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  client_body_timeout </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 设置向客户端发送响应的超时时间。超时设置只限定在两次连续的写入操作之间，而不是用于整个响应的传输。如果客户端在此时间内没有收到任何内容，则连接将被关闭</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  send_timeout </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 告诉nginx关闭不响应的客户端连接，这将会释放该客户端所占有的内存空间</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  reset_timedout_connection </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # =========================================================================</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # ================================= server_name =================================</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 保存服务器名字（server_name www.xx.com这种）的hash表，如果名字太长，就需要将如下值变大为64</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  server_names_hash_bucket_size </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 存储服务器名字的大小，默认512kb，如果一个server对应多个域名，就要加大此值</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  server_names_hash_max_size </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">512</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # =========================================================================</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # ================================= 提交缓存 =================================</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # nginx 会将整个请求头都放在一个 buffer 里面，这个buffer 的大小通过配置项 client_header_buffer_size 来设置，如果用户的请求头太大，这个 buffer 装不下，那 nginx 就会重新分配一个新的更大的 buffer来装请求头，这个大 buffer 可以通过 large_client_header_buffers 来设置，这个 large_buffer 这一组 buffer，比如配置 4 8k，就是表示有四个 8k 大小的buffer 可以用。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  client_header_buffer_size </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32k</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 此指令规定了用于读取大型客户端请求头的缓冲区的最大数量和大小。 这些缓冲区仅在缺省缓冲区不足时按需分配。 当处理请求或连接转换到保持活动状态时，释放缓冲区。如下例子：</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  large_client_header_buffers </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 32k</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 此指令设置NGINX能处理的最大请求主体大小。 如果请求大于指定的大小，则NGINX发回HTTP 413（Request Entity too large）错误。如果在上传大文件，可以将此值设置大一些</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  client_max_body_size </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8m</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 这个将为打开文件指定缓存，默认是没有启用的，max指定缓存数量，建议和打开文件数一致，inactive 是指经过多长时间文件没被请求后删除缓存。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  open_file_cache </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">max=100000 inactive=20s;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 这个是指多长时间检查一次缓存的有效信息。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  open_file_cache_valid </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # open_file_cache指令中的inactive 参数时间内文件的最少使用次数，如果超过这个数字，文件描述符一直是在缓存中打开的，如上例，如果有一个文件在inactive 时间内一次没被使用，它将被移除。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  open_file_cache_min_uses </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 指定了当搜索一个文件时是否缓存错误信息，也包括再次给配置中添加文件。我们也包括了服务器模块，这些是在不同文件中定义的。如果你的服务器模块不在这些位置，你就得修改这一行来指定正确的位置</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  open_file_cache_errors </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">off</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # =========================================================================</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # ================================= 压缩方面 =================================</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 开启页面压缩</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  gzip </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # gzip压缩是要申请临时内存空间的，假设前提是压缩后大小是小于等于压缩前的。例如，如果原始文件大小为10K，那么它超过了8K，所以分配的内存是8 * 2 = 16K;再例如，原始文件大小为18K，很明显16K也是不够的，那么按照 8 * 2 * 2 = 32K的大小申请内存。如果没有设置，默认值是申请跟原始数据相同大小的内存空间去存储gzip压缩结果。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  gzip_buffers </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8k</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 进行压缩的原始文件的最小大小值，也就是说如果原始文件小于1K，那么就不会进行压缩了</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  gzip_min_length </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1K</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 默认值: gzip_http_version 1.1(就是说对HTTP/1.1协议的请求才会进行gzip压缩)项</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 识别http的协议版本。由于早期的一些浏览器或者http客户端，可能不支持gzip自解压，用户就会看到乱码，所以做一些判断还是有必要的。 </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	# 注：99.99%的浏览器基本上都支持gzip解压了，所以可以不用设这个值,保持系统默认即可。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 假设我们使用的是默认值1.1，如果我们使用了proxy_pass进行反向代理，那么nginx和后端的upstream server之间是用HTTP/1.0协议通信的，如果我们使用nginx通过反向代理做Cache Server，而且前端的nginx没有开启gzip，同时，我们后端的nginx上没有设置gzip_http_version为1.0，那么Cache的url将不会进行gzip压缩</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  gzip_http_version </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # gzip压缩比/压缩级别，压缩级别 1-9，级别越高压缩率越大，当然压缩时间也就越长（传输快但比较消耗cpu）。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 默认值：1(建议选择为4)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  gzip_comp_level </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 需要进行gzip压缩的Content-Type的Header的类型。建议js、text、css、xml、json都要进行压缩；图片就没必要了，gif、jpge文件已经压缩得很好了，就算再压，效果也不好，而且还耗费cpu。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  gzip_types </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">text/HTML text/plain application/x-javascript text/css application/xml;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 禁用IE6的gzip压缩，又是因为杯具的IE6。当然，IE6目前依然广泛的存在，所以这里你也可以设置为“MSIE [1-5].”</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # IE6的某些版本对gzip的压缩支持很不好，会造成页面的假死，今天产品的同学就测试出了这个问题后来调试后，发现是对img进行gzip后造成IE6的假死，把对img的gzip压缩去掉后就正常了为了确保其它的IE6版本不出问题，所以建议加上gzip_disable的设置</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  gzip_disable </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;msie6&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Nginx作为反向代理的时候启用，开启或者关闭后端服务器返回的结果，匹配的前提是后端服务器必须要返回包含&quot;Via&quot;的 header头。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # off: 关闭所有的代理结果数据的压缩</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # expired: 启用压缩，如果header头中包含 &quot;Expires&quot; 头信息</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # no-cache: 启用压缩，如果header头中包含 &quot;Cache-Control:no-cache&quot; 头信息</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # no-store: 启用压缩，如果header头中包含 &quot;Cache-Control:no-store&quot; 头信息</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # private: 启用压缩，如果header头中包含 &quot;Cache-Control:private&quot; 头信息</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # no_last_modified: 启用压缩,如果header头中不包含 &quot;Last-Modified&quot; 头信息</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # no_etag: 启用压缩，如果header头中不包含 &quot;ETag&quot; 头信息</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # auth: 启用压缩，如果header头中包含 &quot;Authorization&quot; 头信息</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # any: 无条件启用压缩</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  gzip_proxied </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">any;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 尽量发送压缩过的静态文件</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  gzip_static </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # 监听地址 IPV4</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      listen </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # 监听地址 IPV6</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      listen </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[::]:80;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # 设置编码</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      charset </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">utf-8;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # 设置server_name</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      server_name </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">localhost;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # 根路由</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> / </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          root </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/usr/share/nginx/html;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          index </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">index.html index.htm;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    	# 去掉后缀 / 的写法</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> /docs </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          alias </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/usr/share/nginx/html/docs/;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          index </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">index.html;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-d </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$request_filename) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">              rewrite</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">^/]$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $scheme://$http_host$uri/ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">permanent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # 反向代理写法</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> /api/ </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          proxy_http_version </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          proxy_pass </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">http://192.168.0.102:8888/;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          proxy_set_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">X-Real-IP $remote_addr;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          proxy_set_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">X-Forwarded-For $proxy_add_x_forwarded_for;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          proxy_set_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">X-Forwarded-Proto $scheme;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          proxy_set_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">X-NginX-Proxy </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # 添加跨域配置项</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          add_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Access-Control-Allow-Origin *;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          add_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Access-Control-Allow-Methods </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;POST,GET,OPTIONS,DELETE,PUT&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          add_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Access-Control-Allow-Headers </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">       error_page </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">404</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> = /index.html;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">       error_log </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/var/log/nginx/error.log;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">       access_log </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/var/log/nginx/access.log;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br></div></div><h2 id="参考文章" tabindex="-1">参考文章 <a class="header-anchor" href="#参考文章" aria-label="Permalink to &quot;参考文章&quot;">​</a></h2><ul><li><p><a href="https://docshome.gitbook.io/nginx-docs/" target="_blank" rel="noreferrer">Nginx 中文文档</a></p></li><li><p><a href="https://blog.51cto.com/liuqunying/1420556" target="_blank" rel="noreferrer">nginx 并发数问题思考：worker_connections,worker_processes与 max clients</a></p></li></ul></div></div></main><footer class="VPDocFooter" data-v-e6f2a212 data-v-b77f9094><!--[--><!--]--><div class="edit-info" data-v-b77f9094><div class="edit-link" data-v-b77f9094><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/yqchilde/MyNewBlog/edit/main/posts/blog/2021/nginx-configuration/README.md" target="_blank" rel="noreferrer" data-v-b77f9094><!--[--><span class="vpi-square-pen edit-link-icon" data-v-b77f9094></span> 不妥之处，敬请雅正<!--]--></a></div><div class="last-updated" data-v-b77f9094><p class="VPLastUpdated" data-v-b77f9094 data-v-19a7ae4e>最后更新于: <time datetime="2024-04-22T14:07:59.000Z" data-v-19a7ae4e></time></p></div></div><nav class="prev-next" data-v-b77f9094><div class="pager" data-v-b77f9094><a class="VPLink link pager-link prev" href="/blog/2021/mysql-optimization-notes" data-v-b77f9094><!--[--><span class="desc" data-v-b77f9094>上一篇</span><span class="title" data-v-b77f9094>📝 MySQL的优化笔记</span><!--]--></a></div><div class="pager" data-v-b77f9094><a class="VPLink link pager-link next" href="/blog/2021/macos-remove-freespace" data-v-b77f9094><!--[--><span class="desc" data-v-b77f9094>下一篇</span><span class="title" data-v-b77f9094>📝 MacOS-如何删除Free Space，使得APFS容器将Free Space占用</span><!--]--></a></div></nav></footer><!--[--><!--[--><!--[--><div class="doc-comments"><!----></div><!--]--><!--]--><!--]--></div></div></div><!--[--><!--[--><!--[--><div class="image-viewer"><!----></div><!--]--><!--]--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-d8b57b2d data-v-566314d4><div class="container" data-v-566314d4><!----><p class="copyright" data-v-566314d4>Copyright © 2019-2024 程序员YY | CC BY-NC 4.0 |  <a href="https://beian.miit.gov.cn" target="_blank" rel="nofollow noopener">晋ICP备18003223号-2</a></p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"nav.md\":\"CW5pMvdR\",\"blog_2020_win10-missing-microsoftstore.md\":\"Cr7TW2kO\",\"review_golang_map.md\":\"lIeE_YkS\",\"blog_2020_git-clone-slow.md\":\"B47UqxH5\",\"blog.md\":\"DWPUqRn_\",\"blog_2022_go-mod-private-repo.md\":\"D7CXY77V\",\"blog_2022_sophon-linaro-opencv-gocv.md\":\"BMmUpfvM\",\"blog_2019_mysql-insert-how-where.md\":\"bnsteFDE\",\"blog_2020_golang-request-body-reuse.md\":\"DumAcGfd\",\"blog_2020_golang-learning-context.md\":\"D3ZPKqOz\",\"blog_2020_golang-slice-expand-capacity.md\":\"COi-98BN\",\"blog_2019_uniapp-generate-invitation-qrcode.md\":\"pxK01ep1\",\"blog_2020_windows-cmd-ansi.md\":\"ylVsqk6x\",\"blog_2019_uniapp-generate-random-verification-code.md\":\"CeJ-mO6M\",\"blog_2022_soft-route-notes.md\":\"PptDeMnj\",\"blog_2020_golang-binary-calculation.md\":\"Cc8lBs6l\",\"blog_2022_ubuntu-netplan.md\":\"CgcJTdGm\",\"blog_2020_golang-implements-base-data-structures.md\":\"DeW30GiB\",\"blog_2021_docker-mysql-login-failed.md\":\"d--fJx1f\",\"blog_2020_wordpress-rocket.md\":\"DVmaVXwh\",\"blog_2022_macos-parallels-miss-tap-windows.md\":\"BvPHTdlW\",\"index.md\":\"Juk6_qs4\",\"blog_2021_docker-compose-env-file.md\":\"CIjwWzmf\",\"blog_2020_golang-base64captcha.md\":\"BQnPm4Ll\",\"blog_2019_php-array.md\":\"D7brwfNq\",\"blog_2019_php-phpmailer.md\":\"05IjZ33B\",\"blog_2020_regex-lookground-verify-passowrd.md\":\"CPvpvc2j\",\"workflow_style-guide.md\":\"z5FH_M6m\",\"blog_2021_ubuntu-install-golang.md\":\"CeE7GOA1\",\"blog_2019_mysql5.7-update-password.md\":\"DG8lDsFX\",\"blog_2019_mayisenlin-script.md\":\"QmW7u-jg\",\"blog_2019_uniapp-shoushi-huadong.md\":\"CO68nEJU\",\"blog_2019_uniapp-with-session.md\":\"B0W00BUD\",\"about.md\":\"BSWoNrG4\",\"blog_2019_php-foreach-merge.md\":\"B6QCpIV8\",\"review_golang_slice.md\":\"CbDsZHY6\",\"blog_2020_golang-json-serialization.md\":\"BbpmPNiv\",\"blog_2020_git-command-quick-check.md\":\"7cSGdooP\",\"blog_2019_golang-web-baota.md\":\"BLTsimCI\",\"blog_2020_ubuntu-docker-permission-denied.md\":\"BN16uwAC\",\"review.md\":\"a0HyEF4d\",\"review_golang.md\":\"OYL4OzFc\",\"blog_2021_mysql-optimization-notes.md\":\"CnMGE4ai\",\"blog_2022_soft-route-keepalive.md\":\"Cv59WETr\",\"blog_2022_uninstall-docker-on-macos.md\":\"DhPF4DVA\",\"review_python.md\":\"di38RVe_\",\"blog_2020_hugo-github-actions-aliyun.md\":\"B9wkUND3\",\"blog_2020_golang-trie.md\":\"Dkbb_-k8\",\"blog_2021_nginx-configuration.md\":\"hclfgPua\",\"blog_2021_golang-makefile-and-additional.md\":\"N2p4J7Dx\",\"blog_2021_macos-remove-freespace.md\":\"BjFjdrMu\",\"blog_2020_aria-rpc-motrix-bilibili.md\":\"CeQ816D8\",\"blog_2021_docker-compose-mysql-nginx.md\":\"Dr4RLiDh\",\"blog_2021_golang-race.md\":\"cPPKJevL\",\"blog_2021_point-in-polygon-for-golang.md\":\"DLRbFJnK\",\"blog_2019_uniapp-form-picker.md\":\"RTzlAwL8\",\"blog_2021_template-range-crontab-regex.md\":\"Dyniu-iG\",\"review_python_if.md\":\"DquJpk5a\",\"blog_2022_capslox-karabiner.md\":\"Ch_q3n1Q\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-CN\",\"dir\":\"ltr\",\"title\":\"YY物语\",\"description\":\"程序员YY,yqchilde,程序员,Gopher,热爱技术,中度强迫症,熬夜达人\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"导航\",\"link\":\"/nav\"},{\"text\":\"后端物语\",\"activeMatch\":\"/review/\",\"items\":[{\"text\":\"Golang篇\",\"link\":\"/review/golang\"},{\"text\":\"Python篇\",\"link\":\"/review/python\"}]},{\"text\":\"Workflow\",\"items\":[{\"items\":[{\"text\":\"编程规范\",\"link\":\"/workflow/style-guide\"}]},{\"items\":[{\"text\":\"常用工具库整理\",\"link\":\"/workflow/css/spec\"},{\"text\":\"常用正则整理\",\"link\":\"/workflow/css/tricks\"},{\"text\":\"常用片段整理\",\"link\":\"/workflow/sass/\"}]},{\"items\":[{\"text\":\"命令行工具\",\"link\":\"/workflow/css/spec\"}]},{\"items\":[{\"text\":\"Git 相关技巧\",\"link\":\"/workflow/css/spec\"},{\"text\":\"Git 命令清单\",\"link\":\"/workflow/css/tricks\"}]}],\"activeMatch\":\"^/workflow\"},{\"text\":\"博客\",\"link\":\"/blog\",\"activeMatch\":\"/blog/\"},{\"text\":\"提效工具\",\"items\":[{\"text\":\"软件推荐与配置\",\"items\":[{\"text\":\"多平台软件\",\"link\":\"/efficiency/software/cross-platform\"},{\"text\":\"Mac 平台\",\"link\":\"/efficiency/software/mac\"},{\"text\":\"Windows 平台\",\"link\":\"/efficiency/software/windows\"},{\"text\":\"浏览器设置与扩展\",\"link\":\"/efficiency/software/browser\"},{\"text\":\"Visual Studio Code 配置\",\"link\":\"/efficiency/software/vscode\"},{\"text\":\"WebStorm 配置\",\"link\":\"/efficiency/software/webstorm\"}]},{\"text\":\"在线工具\",\"link\":\"/efficiency/online-tools\"},{\"text\":\"书签脚本\",\"link\":\"/efficiency/bookmark-scripts\"}],\"activeMatch\":\"^/efficiency\"},{\"text\":\"About\",\"link\":\"/about\"}],\"sidebar\":{\"/blog\":[{\"text\":\"2022年 (8篇)\",\"items\":[{\"text\":\"📝 Pve上使用Shell脚本保活虚拟机\",\"link\":\"/blog/2022/soft-route-keepalive\"},{\"text\":\"📝 玩软路由的一些笔记\",\"link\":\"/blog/2022/soft-route-notes\"},{\"text\":\"📝 在算能盒子 (BMNN) 上使用gocv\",\"link\":\"/blog/2022/sophon-linaro-opencv-gocv\"},{\"text\":\"📝 解决在 Apple M1 上使用 Parallels 安装 Windows 后无法使用 OpenVPN 的问题\",\"link\":\"/blog/2022/macos-parallels-miss-tap-windows\"},{\"text\":\"📝 GoModule添加gitlab私有仓库\",\"link\":\"/blog/2022/go-mod-private-repo\"},{\"text\":\"📝 Ubuntu 下关于 Netplan 的一次报错\",\"link\":\"/blog/2022/ubuntu-netplan\"},{\"text\":\"📝 如何使用 Karabiner 来代替 Capslox 的体验\",\"link\":\"/blog/2022/capslox-karabiner\"},{\"text\":\"📝 在Mac上彻底卸载Docker\",\"link\":\"/blog/2022/uninstall-docker-on-macos\"}],\"collapsed\":false},{\"text\":\"2021年 (11篇)\",\"items\":[{\"text\":\"📝 在Ubuntu上安装指定版本的Go语言\",\"link\":\"/blog/2021/ubuntu-install-golang\"},{\"text\":\"📝 Golang实现判断一个点是否在多边形中\",\"link\":\"/blog/2021/point-in-polygon-for-golang\"},{\"text\":\"📝 MySQL的优化笔记\",\"link\":\"/blog/2021/mysql-optimization-notes\"},{\"text\":\"📝 Nginx常用配置\",\"link\":\"/blog/2021/nginx-configuration\"},{\"text\":\"📝 MacOS-如何删除Free Space，使得APFS容器将Free Space占用\",\"link\":\"/blog/2021/macos-remove-freespace\"},{\"text\":\"📝 Golang编译应用通过Github Release实现检测覆盖更新\",\"link\":\"/blog/2021/golang-makefile-and-additional\"},{\"text\":\"📝 Go的template模板关于range换行和crontab的简单正则表达式\",\"link\":\"/blog/2021/template-range-crontab-regex\"},{\"text\":\"📝 docker-compose使用env处理环境变量妙用\",\"link\":\"/blog/2021/docker-compose-env-file\"},{\"text\":\"📝 Docker Compose简单配置Mysql Nginx挂载持久化\",\"link\":\"/blog/2021/docker-compose-mysql-nginx\"},{\"text\":\"📝 Docker安装MySQL后无法登录\",\"link\":\"/blog/2021/docker-mysql-login-failed\"},{\"text\":\"📝 Golang的Data Race问题\",\"link\":\"/blog/2021/golang-race\"}],\"collapsed\":true},{\"text\":\"2020年 (17篇)\",\"items\":[{\"text\":\"📝 Golang的Request.Body复用\",\"link\":\"/blog/2020/golang-request-body-reuse\"},{\"text\":\"📝 Ubuntu启动Docker报没有权限\",\"link\":\"/blog/2020/ubuntu-docker-permission-denied\"},{\"text\":\"📝 MacOS-如何删除Free Space，使得APFS容器将Free Space占用\",\"link\":\"/blog/2020/win10-missing-microsoftstore\"},{\"text\":\"📝 Golang实现一个简单的密码强度验证\",\"link\":\"/blog/2020/regex-lookground-verify-passowrd\"},{\"text\":\"📝 使用GitHub Actions部署Hugo到阿里云\",\"link\":\"/blog/2020/hugo-github-actions-aliyun\"},{\"text\":\"📝 Git常用命令速查表\",\"link\":\"/blog/2020/git-command-quick-check\"},{\"text\":\"📝 Golang的json序列化详解\",\"link\":\"/blog/2020/golang-json-serialization\"},{\"text\":\"📝 Golang的Context学习\",\"link\":\"/blog/2020/golang-learning-context\"},{\"text\":\"📝 Golang的Slice扩容机制\",\"link\":\"/blog/2020/golang-slice-expand-capacity\"},{\"text\":\"📝 Golang实现进制计算两种方法\",\"link\":\"/blog/2020/golang-binary-calculation\"},{\"text\":\"📝 Golang实现几种基本数据结构\",\"link\":\"/blog/2020/golang-implements-base-data-structures\"},{\"text\":\"📝 Golang实现简单Trie树\",\"link\":\"/blog/2020/golang-trie\"},{\"text\":\"📝 正确配置rocket-nginx，加速你的wordpress\",\"link\":\"/blog/2020/wordpress-rocket\"},{\"text\":\"📝 Golang验证码–base64Captcha库1.3.0版本构建实例\",\"link\":\"/blog/2020/golang-base64captcha\"},{\"text\":\"📝 Git设置代理解决git clone太慢的问题\",\"link\":\"/blog/2020/git-clone-slow\"},{\"text\":\"📝 油猴脚本 + Aria RPC + Motrix批量下载哔哩哔哩视频\",\"link\":\"/blog/2020/aria-rpc-motrix-bilibili\"},{\"text\":\"📝 解决win10的cmd命令行不转义ANSI序列（让cmd输出彩色字体）\",\"link\":\"/blog/2020/windows-cmd-ansi\"}],\"collapsed\":true},{\"text\":\"2019年 (12篇)\",\"items\":[{\"text\":\"📝 golang写的web程序如何简单的部署到宝塔面板中\",\"link\":\"/blog/2019/golang-web-baota\"},{\"text\":\"📝 MySQL中insert数据时怎么用where条件\",\"link\":\"/blog/2019/mysql-insert-how-where\"},{\"text\":\"📝 MySQL5.7修改root密码\",\"link\":\"/blog/2019/mysql5.7-update-password\"},{\"text\":\"📝 利用脚本软件“一触即发”写一个自动收取，偷取支付宝能量脚本\",\"link\":\"/blog/2019/mayisenlin-script\"},{\"text\":\"📝 PHPMailer6.0.7如何在类中被调用\",\"link\":\"/blog/2019/php-phpmailer\"},{\"text\":\"📝 php多维数组降维记载\",\"link\":\"/blog/2019/php-array\"},{\"text\":\"📝 php在foreach里面合并数组\",\"link\":\"/blog/2019/php-foreach-merge\"},{\"text\":\"📝 uniapp的Form提交之蛋疼的picker\",\"link\":\"/blog/2019/uniapp-form-picker\"},{\"text\":\"📝 Uni-App生成邀请二维码\",\"link\":\"/blog/2019/uniapp-generate-invitation-qrcode\"},{\"text\":\"📝 uniapp生成随机验证码&php合成验证码图片\",\"link\":\"/blog/2019/uniapp-generate-random-verification-code\"},{\"text\":\"📝 Uni-App之携带session请求\",\"link\":\"/blog/2019/uniapp-with-session\"},{\"text\":\"📝 Uni-App的手势监听滑动\",\"link\":\"/blog/2019/uniapp-shoushi-huadong\"}],\"collapsed\":true}],\"/review\":[{\"text\":\"Golang篇 (2篇)\",\"items\":[{\"text\":\"📝 Map\",\"link\":\"/review/golang/map\"},{\"text\":\"📝 Slice\",\"link\":\"/review/golang/slice\"}],\"collapsed\":false},{\"text\":\"Python篇 (1篇)\",\"items\":[{\"text\":\"📝 If\",\"link\":\"/review/python/if\"}],\"collapsed\":false}],\"/workflow\":[{\"text\":\"编程规范 \",\"items\":[],\"collapsed\":false}]},\"logo\":{\"light\":\"/logo_light.svg\",\"dark\":\"/logo_night.svg\"},\"outline\":{\"label\":\"页面导航\",\"level\":\"deep\"},\"editLink\":{\"pattern\":\"https://github.com/yqchilde/MyNewBlog/edit/main/:path\",\"text\":\"不妥之处，敬请雅正\"},\"lastUpdated\":{\"text\":\"最后更新于\",\"formatOptions\":{\"dateStyle\":\"short\",\"timeStyle\":\"medium\"}},\"docFooter\":{\"prev\":\"上一篇\",\"next\":\"下一篇\"},\"search\":{\"provider\":\"local\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/yqchilde\"}],\"footer\":{\"copyright\":\"Copyright © 2019-2024 程序员YY | CC BY-NC 4.0 |  <a href=\\\"https://beian.miit.gov.cn\\\" target=\\\"_blank\\\" rel=\\\"nofollow noopener\\\">晋ICP备18003223号-2</a>\"},\"articleMetadataConfig\":{\"author\":\"YY\",\"authorLink\":\"/about\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>